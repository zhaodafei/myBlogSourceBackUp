---
title: 微信H5判断环境
date: 2024-08-10
categories: 
- 微信
tags:
- 微信
---
微信`H5`判断环境,是否是微信环境
微信`H5`判断环境,是否是微信环境
微信`H5`判断环境,是否是微信环境

<!-- more -->

### H5判断环境

`H5`判断是否是微信环境

```html
<html>
  <head>
    <title>判断是否是微信环境</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1">
    <script>
      window.onerror = e => {
        console.error(e)
        alert('发生错误' + e)
      }
    </script>
    <!-- weui 样式 -->
    <!--<link rel="stylesheet" href="https://res.wx.qq.com/open/libs/weui/2.4.1/weui.min.css"></link>-->
    <!-- 调试用的移动端 console -->
    <!-- <script src="https://cdn.jsdelivr.net/npm/eruda"></script> -->
    <!-- <script>eruda.init();</script> -->
    <!-- 公众号 JSSDK -->
    <!--<script src="https://res.wx.qq.com/open/js/jweixin-1.6.0.js"></script>-->
    <!-- 云开发 Web SDK -->
    <!--<script src="https://res.wx.qq.com/open/js/cloudbase/1.1.0/cloud.js"></script>-->
    <script>
      function docReady(fn) {
        if (document.readyState === 'complete' || document.readyState === 'interactive') {
          fn()
        } else {
          document.addEventListener('DOMContentLoaded', fn);
        }
      }

      docReady(async function() {
        var ua = navigator.userAgent.toLowerCase()
        var isWXWork = ua.match(/wxwork/i) == 'wxwork'
        var isWeixin = !isWXWork && ua.match(/micromessenger/i) == 'micromessenger'
        var isMobile = false
        var isDesktop = false
        if (navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|IEMobile)/i)) {
          isMobile = true
        } else {
          isDesktop = true
        }

        if (isWeixin) {
          console.log('微信环境_11111');
          var containerEl = document.getElementById('wechat-web-container')
          containerEl.classList.remove('hidden')
          containerEl.classList.add('full', 'wechat-web-container')
        } else if (isDesktop) {
          console.log('PC环境_222222');
          // 在 pc 上则给提示引导到手机端打开
          var containerEl = document.getElementById('desktop-web-container')
          containerEl.classList.remove('hidden')
          containerEl.classList.add('full', 'desktop-web-container')
        }  else if(isMobile) {
          // H5 页面
          console.log('H5环境_333333');
          var containerEl = document.getElementById('public-web-container')
          containerEl.classList.remove('hidden')
          containerEl.classList.add('full', 'public-web-container')
        }
      })
    </script>
    <style>
      .hidden {
        display: none;
      }

      .full {
        position: absolute;
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
      }

      .public-web-container {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .public-web-container p {
        position: absolute;
        top: 40%;
      }

      .wechat-web-container {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .wechat-web-container p {
        position: absolute;
        top: 40%;
      }

      .desktop-web-container {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .desktop-web-container p {
        position: absolute;
        top: 40%;
      }
    </style>
  </head>
  <body>
  <!--
  代码来源(h5跳小程序):
  https://developers.weixin.qq.com/miniprogram/dev/wxcloudservice/wxcloud/guide/staticstorage/jump-miniprogram.html
  -->
    <div class="page full">
      <div id="wechat-web-container" class="hidden">
        <p class="">已经进入微信环境111</p>
      </div>
      <div id="desktop-web-container" class="hidden">
        <p class="">PC: 请在手机打开网页链接</p>
      </div>
      <div id="public-web-container" class="hidden">
        <p class="">H5 环境</p>
      </div>
    </div>
  </body>
</html>

```



### sdk判断

```js
import wx from 'weixin-js-sdk'

wx.miniProgram.getEnv(res => {
  if (res.miniprogram) {
    alert("miniProgram");
  } else {
    alert("weChat");
  }
})
```



### 底部

没有了



















